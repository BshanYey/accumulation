
#大数据
    数据多，记录数在千万级或者亿级甚至更多
    存储体量在TB级甚至PB级以上
    存储在一个或者多个服务器上

#大数据技术
    对大数据量进行分析和挖掘，挖掘出数据中蕴含的有意义的东西，比如：规律、趋势、喜好等，并据此作出一定的推理和预测
    通常会涉及数据仓库、数据挖掘、人工智能AI、机器学习等方面的技术
    
#大数据量带来的影响及问题
    业务查询变慢、响应时间变慢、整个应用变慢；高并发下多次操作导致数据库崩溃
    本质问题是：需要操作的数据的基数太大
    
#数据的分类

##联机事务处理（OLTP）    
    面向交易的处理系统，特征是数据需要立即传送到计算中心进行处理，并在短时间给出处理结果
    面对日常交易，要求实时处理数据，事务强一致性
##联机分析处理（OLAP）
    通过多维的访视对数据进行分析、查询、报表，不必要即时给出相应结果
    面向统计分析等、实时性要求不高，弱事务性
    
#关于大数据处理的思路
    分流（负载均衡、反向代理等）
        用和不用、常用和不常用的数据分开存储（ps：近期的订单可能需要经常查询，1年前的订单可能不经常查询，则分开存储）
        对数据库存放的数据：分区、分库、分表
        对文件存放的数据：拆文件
        考虑分批处理
        原则：尽量使每次操作的数据的基数减少
    处理优化
        优化sql
        考虑使用临时表、中间表
    缓存技术
        读多写少用缓存
    合理使用nosql
        MongoDB、Redis、HBase等
    数据库优化
        合理设计数据库结构
        合力创建索引
        数据库集群
    分布式大数据处理方案
        Hadoop、Spark、Storm等
        
        
#数据库分区（mysql）
    分区就是将一个表分成多个区块进行操作和保存，从而降低每次操作的数据，以提高性能。
    对于应用来说是透明的，从逻辑上看只是一张表，只是在物理存储上这个表可能由多个物理分区组成，每个分区都是一个独立的对象，可以独立进行处理。
    ps：可以理解为，不分区的时候一张表存在一个文件里边，分区的时候存在多个文件里边，每个文件对象可以单独操作，即查询的时候可能只查询多个文件中的一个
        
##mysql支持引擎
    myisam、innodb等支持
    merge、csv等不支持
    ps：同一个分区表中的所有分区必须是同一个存储引擎
       
##优缺点：
    优点：
        • 进行逻辑数据分割，分割数据能够有多个不同的物理文件路径
        • 可以存储更多的数据，突破系统单个文件最大限制
        • 提升性能，提高每个分区的读写速度，提高分区范围查询的速度
        • 可以通过删除相关分区来快速删除数据
        • 通过跨多个磁盘来分散数据查询，从而提高磁盘I/O的性能
        • 涉及到例如SUM()和COUNT()这样聚合函数的查询，可以很容易地进行并行处理
        • 可以备份和恢复独立的分区，这对大数据量很有好处
    缺点：

##mysql分区创建
    分区命名
        分区名字不区分大小写、命名上遵循mysql命名的原则，和用于数据库名、表名的标识符一样。
        无论哪种类型的分区，分区在创建的时候会自动的顺序编号，从0开始记录
        
##分区类型（ps：分区数没有上限）
    RANGE分区
        一个给定连续区间的列值（ps：0-100在第一个分区，101-200在第二个分区）
    LIST分区
        List是匹配一个离散值集合中的某个值来进行选择
    HASH分区
        用户自定义表达式的返回值来进行hash计算之后选择分区，该表达式使用将要插入到表中的这些行的列值进行计算，这个函数必须产生非负整数值
    KEY分区        
        类似于HASH分区，由mysql服务器提供自身的hash函数
        
##分区注意事项
     最大分区数目不能超过1024，一般建议对单表的分区数不要超过150个
     如果含有唯一索引或者主键，则分区列必须包含在所有的唯一索引或者主键之内
     不支持外键
     不支持全文索引，对分区表的分区键创建索引，那么这个索引也将被分区
     按日期进行分区很合适，因为很多日期函数可以用。但是对于字符串来说合适的分区函数不太多
     只有RANG和LIST分区能进行子分区， HASH和KEY分区不能进行子分区
     分区表对于单条记录的查询没有优势
     要注意选择分区的成本，每插入一行数据都需要按照表达式筛选插入的分区
     分区字段尽量不要可以为null        
        
        
        
        
#数据分片
    数据分片指按照某个维度将存放在单一数据库中的数据分散地存放至多个数据库或者表中
    数据库分片的有效手段是对关系型数据库进行分库和分表
##分库（垂直拆分）
    分库又叫垂直拆分，或者纵向拆分，指的是按照业务模块将数据分散到不同的数据库服务器中
    优点：
        拆分之后业务清晰，拆分规则明确
        系统之间整合或扩展容易
        数据维护简单
    缺点：
        部分业务表无法join，只能通过接口的方式解决，提高了系统复杂度
        受每种业务不同的限制存在单库性能瓶颈，不易数据扩展和性能提高
        事务处理复杂
##分表（水平拆分）（有点像数据库分区）
    垂直拆分可以缓冲数据量和访问量过大带来的问题，但是无法根治。如果单个表的数据量过大，超出了单表的存储上限依然会存在问题，这个时候需要水平分片来做进一步的处理。
    分表又叫水平拆分，通过某个（某几个）字段，根据某种规则或逻辑。将一张表的数据拆分成多份。
    水平分表
        将本来可以在同一个表的内容，划分到到多个表中，每个表结构一样。
    垂直分表
        将一个表复制成表结构不同的表，将原有表的字段分到不同的表中。
    优点
        拆分规则抽象好，join操作基本可以数据库做
        不存在单库大数据、高并发的性能瓶颈
        应用端改造少
        提高了系统稳定性和负载能力
    缺点
        拆分规则难以抽象
        分片事务一致性难以解决
        数据多次扩展难度跟维护量极大
        跨库join性能差（聚合函数会有问题count、order by等）
    
#注意    
    一般先垂直（分库）在水平（分表）   
#数据分片存在的问题
    分布式事务的问题
    跨节点join的问题
    跨节点合并排序分页的问题
    多数据源管理问题
    
##数据分片优缺点
    优点
        解决单个文件上限问题
        减少了查询基数以提高查询效率
        单表数量下降导致需要扫描的记录，减少了磁盘io
        有操作锁表的时候不会锁掉所有数据，减少排队的时间，增加了吞吐量
    缺点    
            
    分库原则
        分析业务功能，以及表之间的聚合关系，把关系紧密的表放在一起
        分库的粒度指的是在做切分时允许几级的关联表放在一起。关联打断的越多，受影响的join操作越多。
        若是规划到一起的表关系紧密，且数据量不大，增长也缓慢，则适合放在一起，不需要在进行水平切分。
        若是规划到一起的表数据量大且增长迅猛，则势必要在分库的基础上在进行分表，必然会导致复杂度增加，需要在一开始就考虑进去。
    分表原则
            对于垂直分片，通常是按照业务功能的使用频次，把主要的、热门的字段放在一起作为主表。把不常用的，按照各自的业务属性进行聚集，拆分到不同的次要表中，主要表和次要表的关系一般是一对一的。
            拆分规则需要根据业务来决定，每种拆分规则都有起局限性。
    数据库拆分原则
        1、能不切分尽量不要切分
        2、如果要切分一定要选择合适的切分规则，提前规划好
        3、数据切分尽量通过数据冗余或者表分组来降低跨库join的可能性
        4、由于数据库中间件对join实现的优劣难以把握，而且实现高性能的难度极大，业务读取尽量少使用多表join
       
#数据库中间件--mycat
##什么是mycat       
    http://www.mycat.io
    基于阿里的cobar的开源的数据库中间件，支持多种数据库（最初是为了支持mysql开发的，所以mysql支持最好）。
    注：mycat是基于java开发的，所以需要java环境
##
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    